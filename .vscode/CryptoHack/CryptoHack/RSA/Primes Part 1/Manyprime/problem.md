Using one prime factor was definitely a bad idea so I'll try using over 30 instead.

 If it's taking forever to factorise, read up on factorisation algorithms and make sure you're using one that's optimised for this scenario.